(function(){"use strict";var e={8568:function(e,t,o){var n=o(144),r=o(998),a=o(8003),i=o(3059),s=function(){var e=this,t=e._self._c;return t(r.Z,[t(i.Z,[t("HomeView")],1),t(a.Z,{staticClass:"justify-center",attrs:{padless:""}},[t("p",{staticClass:"text-center pa-4 ma-0"},[e._v("Crafted with ‚ù§ by Haridev"),t("br"),e._v(" Links: "),t("a",{attrs:{href:"https://github.com/gharidev",target:"_blank"}},[e._v("Github")]),e._v(" | "),t("a",{attrs:{href:"https://haridev.me",target:"_blank"}},[e._v("Portfolio")])])])],1)},l=[],c=o(6190),d=o(9582),u=o(4886),h=o(4127),m=o(266),p=o(4699),g=o(2118),f=o(2631),v=o(9223),b=o(1042),w=o(4324),k=o(5495),x=o(5808),_=o(4525),y=o(523),Z=o(9592),C=o(6243),S=o(7251),I=o(1713),O=o(7423),T=o(7414),D=o(9258),j=o(3687),F=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"min-height":"100%"}},[e.loading?t("div",{staticClass:"convert-progress"},[t(Z.Z,{attrs:{"buffer-value":"100",color:"success lighten-2"},model:{value:e.percentage,callback:function(t){e.percentage=t},expression:"percentage"}})],1):e._e(),t(g.Z,[t(I.Z,{attrs:{justify:"center"}},[t(m.Z,{attrs:{cols:"12",md:"6"}},[t("div",[t(k.Z,{staticClass:"mx-auto",attrs:{src:o(4757),width:"150"}})],1),t(d.Z,{staticClass:"my-3 rounded-xl"},[t(u.EB,{staticClass:"justify-center"},[e._v(" Select Images ")]),t(u.ZB,[t("div",[t(b.Z,{ref:"images",staticClass:"file-input",attrs:{color:"primary accent-4",counter:"",label:"File input",multiple:"",placeholder:"Select your files","prepend-icon":"mdi-paperclip",outlined:"",rounded:"","show-size":1e3,accept:"image/*"},scopedSlots:e._u([{key:"selection",fn:function({index:o,text:n}){return[o<2?t(h.Z,{attrs:{color:"primary accent-4",dark:"",label:"",small:""}},[e._v(" "+e._s(n)+" ")]):2===o?t("span",{staticClass:"text-overline grey--text text--darken-3 mx-2"},[e._v(" +"+e._s(e.files.length-2)+" File(s) ")]):e._e()]}}]),model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),t("div",{staticClass:"mt-2"},[t("p",{staticClass:"mb-2 title"},[e._v("Background")]),t(S.Z,{model:{value:e.background.option,callback:function(t){e.$set(e.background,"option",t)},expression:"background.option"}},[t(C.Z,{attrs:{value:"transparent"},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",[e._v("Transparent "),t("span",{staticClass:"caption"},[e._v("Sets the background as transparent.")])])]},proxy:!0}])}),t(C.Z,{attrs:{value:"automatic"},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",[e._v("Automatic color "),t("span",{staticClass:"caption"},[e._v("Sets background color automatically.")])])]},proxy:!0}])}),t(C.Z,{attrs:{value:"custom"},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",[t("p",{staticClass:"mb-2"},[e._v("Custom color")]),t(p.Z,{attrs:{disabled:"custom"!=e.background.option,"dot-size":"25","hide-inputs":"","hide-mode-switch":"",mode:"hexa","swatches-max-height":"200"},model:{value:e.background.selected,callback:function(t){e.$set(e.background,"selected",t)},expression:"background.selected"}})],1)]},proxy:!0}])}),t(C.Z,{attrs:{value:"blur"},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",[e._v(" Blurred "),t("span",{staticClass:"caption"},[e._v("Source image blurred in background.")]),t("div",[t(T.Z,{staticClass:"blur-range-slider",attrs:{label:"Blur radius",max:"50",min:"1",disabled:"blur"!=e.background.option},model:{value:e.background.radius,callback:function(t){e.$set(e.background,"radius",t)},expression:"background.radius"}})],1)])]},proxy:!0}])})],1)],1)],1),t("div",{staticClass:"text-center"},[t(c.Z,{attrs:{color:"primary",disabled:e.loading||0==e.files.length,rounded:""},on:{click:e.onSubmit}},[e._v("Square Fit'em")])],1)])],1),e.completed.length>0?[t("p",{staticClass:"title mb-2"},[e._v("Completed")]),t(x.Z,{staticClass:"rounded-xl",attrs:{rounded:""}},[e._l(e.completed,(function(o,n){return[t(_.Z,{key:n,staticClass:"rounded-xl my-1",on:{click:function(t){return e.previewImage(n)}}},[t(y.Z,{attrs:{rounded:"0"}},[t(k.Z,{attrs:{src:o.url}})],1),t(j.Z),t(c.Z,{attrs:{color:o.downloaded?"success":"primary",rounded:""},on:{click:function(t){return t.stopPropagation(),e.downloadImage(n)}}},[t(w.Z,{attrs:{dark:"",left:""}},[e._v(" "+e._s(o.downloaded?"mdi-check":"mdi-download")+" ")]),e._v(" "+e._s(o.downloaded?"Downloaded":"Download")+" ")],1)],1),n!=e.completed.length-1?t(v.Z,{key:n+"divider",attrs:{inset:!1}}):e._e()]}))],2),t(c.Z,{staticClass:"my-5 mx-auto",attrs:{block:"",large:"",color:"primary",rounded:""},on:{click:function(t){return e.bulkDownload()}}},[t(w.Z,{attrs:{dark:"",left:""}},[e._v(" mdi-download ")]),e._v("Download all ")],1),e.completed.some((e=>e.downloaded))&&e.completed.filter((e=>e.downloaded)).length!=e.completed.length?t(c.Z,{staticClass:"mx-auto mb-4",attrs:{block:"",large:"",color:"primary",rounded:""},on:{click:function(t){return e.bulkDownload(!1)}}},[t(w.Z,{attrs:{dark:"",left:""}},[e._v(" mdi-download ")]),e._v("Download remaining ")],1):e._e()]:e._e(),e.errors?t("ul",{staticClass:"list-group list-group-flush"},e._l(e.errors,(function(o,n){return t("li",{key:n,staticClass:"list-group-item text-danger"},[e._v(e._s(n+1)+") "+e._s(o))])})),0):e._e()],2)],1)],1),t(f.Z,{attrs:{width:"500"},model:{value:e.preview,callback:function(t){e.preview=t},expression:"preview"}},[null!=e.previewIndex?t(O.Z,{staticClass:"pa-4 text-center",attrs:{rounded:"",set:e.image=e.completed[e.previewIndex]}},[t(k.Z,{staticClass:"mb-3",attrs:{src:e.image.url,alt:"Square pic result"}},[t("div",{staticClass:"image-controls",class:{"left-end":0==e.previewIndex,"right-end":e.previewIndex==e.completed.length-1}},[t("div",{staticClass:"left",on:{click:function(t){e.previewIndex>0&&e.previewIndex--}}},[t(w.Z,{attrs:{"x-large":""}},[e._v("mdi-chevron-left")])],1),t("div",{staticClass:"right",on:{click:function(t){e.previewIndex<e.completed.length-1&&e.previewIndex++}}},[t(w.Z,{attrs:{"x-large":""}},[e._v("mdi-chevron-right")])],1)])]),t(c.Z,{attrs:{color:e.image.downloaded?"success":"primary",rounded:""},on:{click:function(t){return e.downloadImage(e.previewIndex)}}},[t(w.Z,{attrs:{dark:"",left:""}},[e._v(" "+e._s(e.image.downloaded?"mdi-check":"mdi-download")+" ")]),e._v(" "+e._s(e.image.downloaded?"Downloaded":"Download")+" ")],1)],1):e._e()],1),t(D.Z,{attrs:{timeout:e.snackbar.timeout,color:e.snackbar.color},model:{value:e.snackbar.show,callback:function(t){e.$set(e.snackbar,"show",t)},expression:"snackbar.show"}},[e._v(" "+e._s(e.snackbar.msg))])],1)},P=[],$=(o(8675),o(7380),o(1118),o(1703),{name:"HomeView",data(){return{files:[],loading:!1,errors:[],previewIndex:null,preview:!1,background:{option:"automatic",selected:"#FFFFFF",radius:8},progress:{total:0,loaded:0},dim:2048,ctx:null,completed:[],suffix:(new Date).getTime().toString(32),snackbar:{show:!1,timeout:2e3,color:"success",msg:""},count:0}},computed:{percentage(){return 100*this.progress.loaded/(this.progress.total||1)}},watch:{"progress.loaded":function(e,t){e==this.progress.total&&(this.showSnackBar("Process complete.","success"),setTimeout((()=>{this.loading=!1}),1e3),this.files=[],window.localStorage.setItem("converted-count",this.count))},"background.option":function(e){window.localStorage.setItem("selected-option",e)}},methods:{showSnackBar(e,t="success"){const o=this.snackbar;o.msg=e,o.color=t,o.show=!0},addToCompleted(e,t){this.completed.push({url:e,downloaded:!1,filename:t})},previewImage(e){this.previewIndex=e,this.preview=!0},downloadImage(e){const t=this.completed[e];var o=document.createElement("a");o.href=t.url,o.download=t.filename,document.body.appendChild(o),o.click(),o.remove(),t.downloaded=!0},bulkDownload(e=!0){this.completed.forEach(((t,o)=>{!e&&t.downloaded||this.downloadImage(o)}))},componentToHex(e){var t=e.toString(16);return 1==t.length?"0"+t:t},rgbToHex(e,t,o){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(o)},getAutomaticColor(e){const t=document.createElement("canvas");t.height=e.height,t.width=e.width;const o=t.getContext("2d");o.drawImage(e,0,0);const n={};if(e.height>e.width){const t=new Uint8ClampedArray([...o.getImageData(0,0,1,e.height).data,...o.getImageData(e.width-1,0,1,e.height).data]);for(let o=0;o<4*e.height*2;o+=4){const e=this.rgbToHex(t[o],t[o+1],t[o+2]);n[e]=(n[e]??0)+1}}else{const t=new Uint8ClampedArray([...o.getImageData(0,0,e.width,1).data,...o.getImageData(0,e.height-1,e.width,1).data]);for(let o=0;o<4*e.width*2;o+=4){const e=this.rgbToHex(t[o],t[o+1],t[o+2]);n[e]=(n[e]??0)+1}}let r,a=-1;console.log(n);for(let[i,s]of Object.entries(n))s>a&&(r=i,a=s);return r},handleOnline(e,t){let o=new FormData;o.append("image",e),fetch(`?${t.toString()}`,{method:"POST",body:o}).then((e=>{if(e.ok)return e.blob();throw new Error(e.statusText)})).then((e=>{var t=window.URL.createObjectURL(e);this.addToCompleted(t)})).catch((e=>{this.errors.push(e.message)})).then((()=>{this.progress.loaded++}))},handleOffline(e){const t=new FileReader;t.addEventListener("load",(()=>{const e=new Image;e.src=t.result;const o=this.background.option;e.onload=()=>{let t=this.background.selected;const n=e.height,r=e.width;if(this.ctx.clearRect(0,0,this.dim,this.dim),this.ctx.beginPath(),this.ctx.rect(0,0,this.dim,this.dim),["automatic","blur"].includes(o)&&(t=this.getAutomaticColor(e)),["automatic","custom","blur"].includes(o)&&(this.ctx.fillStyle=t,this.ctx.fill()),"blur"===o){let t,o;this.ctx.filter=`blur(${this.background.radius}px)`,r>n?(t=r*(this.dim/n),o=this.dim,this.ctx.drawImage(e,(this.dim-t)/2,0,t,o)):(o=n*(this.dim/r),t=this.dim,this.ctx.drawImage(e,0,(this.dim-o)/2,t,o)),this.ctx.filter="blur(0px)"}let a,i,s=0,l=0;n>r?(a=r/(n/this.dim),i=this.dim,s=(this.dim-a)/2,l=0):(i=n/(r/this.dim),a=this.dim,s=0,l=(this.dim-i)/2),this.ctx.drawImage(e,s,l,a,i),this.progress.loaded++,this.count++;const c="transparent"==o?"png":"jpeg",d=`${this.count}`.padStart(4,"0");this.addToCompleted(this.ctx.canvas.toDataURL(`image/${c}`),`Bulk-Squarefit ${(new Date).toISOString().slice(0,10)}-IMG${d}.${c}`)}}),!1),t.readAsDataURL(e)},onSubmit(){if(this.files.length){this.loading=!0,this.progress.loaded=0,this.progress.total=this.files.length;for(let e of this.files)this.handleOffline(e)}else this.showSnackBar("Add images","red")}},mounted(){const e=document.createElement("canvas");e.height=this.dim,e.width=this.dim,this.ctx=e.getContext("2d")},created(){this.count=Number(window.localStorage.getItem("converted-count")??0);const e=window.localStorage.getItem("selected-option")??"automatic";["automatic","custom","blur","transparent"].includes(e)&&(this.background.option=e)}}),A=$,H=o(1001),B=(0,H.Z)(A,F,P,!1,null,null,null),q=B.exports,E={name:"App",components:{HomeView:q},data:()=>({})},L=E,R=(0,H.Z)(L,s,l,!1,null,null,null),U=R.exports,M=o(7813);n.ZP.use(M.Z);var N=new M.Z({theme:{dark:!0,themes:{dark:{primary:"#8a00e6"}}}}),z=o(5205);(0,z.z)("/bulk-squarefit/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),n.ZP.config.productionTip=!1,new n.ZP({vuetify:N,render:e=>e(U)}).$mount("#app")},4757:function(e,t,o){e.exports=o.p+"img/bulk-squarefit.7ab8c38f.svg"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,a){if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],a=e[d][2];for(var s=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,r,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/bulk-squarefit/"}(),function(){var e={826:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,i=n[0],s=n[1],l=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var d=l(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},n=self["webpackChunkbulk_squarefit"]=self["webpackChunkbulk_squarefit"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(8568)}));n=o.O(n)})();
//# sourceMappingURL=index.4f33b5f9.js.map