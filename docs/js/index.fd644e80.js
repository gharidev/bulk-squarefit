(function(){"use strict";var t={1803:function(t,e,o){var a=o(144),n=o(998),r=o(8003),i=o(3059),s=function(){var t=this,e=t._self._c;return e(n.Z,[e(i.Z,[e("HomeView")],1),e(r.Z,{staticClass:"justify-center",attrs:{padless:""}},[e("p",{staticClass:"text-center pa-4 ma-0"},[t._v("Crafted with ‚ù§ by Haridev"),e("br"),t._v(" Links: "),e("a",{attrs:{href:"https://github.com/gharidev",target:"_blank"}},[t._v("Github")]),t._v(" | "),e("a",{attrs:{href:"https://haridev.me",target:"_blank"}},[t._v("Portfolio")])])])],1)},l=[],c=o(6190),d=o(9582),u=o(4886),h=o(4127),m=o(266),p=o(6167),g=o(2118),f=o(2631),v=o(9223),b=o(1042),w=o(4324),k=o(5495),x=o(5808),_=o(4525),y=o(523),Z=o(9592),C=o(6243),S=o(7251),I=o(1713),O=o(7423),T=o(7414),D=o(9258),j=o(3687),F=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"min-height":"100%"}},[t.loading?e("div",{staticClass:"convert-progress"},[e(Z.Z,{attrs:{"buffer-value":"100",color:"success lighten-2"},model:{value:t.percentage,callback:function(e){t.percentage=e},expression:"percentage"}})],1):t._e(),e(g.Z,[e(I.Z,{attrs:{justify:"center"}},[e(m.Z,{attrs:{cols:"12",md:"6"}},[e("h3",{staticClass:"text-center display-1"},[t._v("Bulk SquareFit")]),e(d.Z,{staticClass:"my-3 rounded-xl"},[e(u.EB,{staticClass:"justify-center"},[t._v(" Select Images ")]),e(u.ZB,[e("div",[e(b.Z,{ref:"images",staticClass:"file-input",attrs:{color:"primary accent-4",counter:"",label:"File input",multiple:"",placeholder:"Select your files","prepend-icon":"mdi-paperclip",outlined:"",rounded:"","show-size":1e3,accept:"image/*"},scopedSlots:t._u([{key:"selection",fn:function({index:o,text:a}){return[o<2?e(h.Z,{attrs:{color:"primary accent-4",dark:"",label:"",small:""}},[t._v(" "+t._s(a)+" ")]):2===o?e("span",{staticClass:"text-overline grey--text text--darken-3 mx-2"},[t._v(" +"+t._s(t.files.length-2)+" File(s) ")]):t._e()]}}]),model:{value:t.files,callback:function(e){t.files=e},expression:"files"}}),e("div",{staticClass:"mt-2"},[e("p",{staticClass:"mb-2 title"},[t._v("Background")]),e(S.Z,{model:{value:t.background.option,callback:function(e){t.$set(t.background,"option",e)},expression:"background.option"}},[e(C.Z,{attrs:{value:"transparent"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[t._v("Transparent "),e("span",{staticClass:"caption"},[t._v("Sets the background as transparent.")])])]},proxy:!0}])}),e(C.Z,{attrs:{value:"automatic"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[t._v("Automatic color "),e("span",{staticClass:"caption"},[t._v("Sets background color automatically.")])])]},proxy:!0}])}),e(C.Z,{attrs:{value:"custom"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[e("p",{staticClass:"mb-2"},[t._v("Custom color")]),e(p.Z,{attrs:{disabled:"custom"!=t.background.option,"dot-size":"25","hide-inputs":"","hide-mode-switch":"",mode:"hexa","swatches-max-height":"200"},model:{value:t.background.selected,callback:function(e){t.$set(t.background,"selected",e)},expression:"background.selected"}})],1)]},proxy:!0}])}),e(C.Z,{attrs:{value:"blur"},scopedSlots:t._u([{key:"label",fn:function(){return[e("div",[t._v(" Blurred "),e("span",{staticClass:"caption"},[t._v("Source image blurred in background.")]),e("div",[e(T.Z,{staticClass:"blur-range-slider",attrs:{label:"Blur radius",max:"50",min:"1",disabled:"blur"!=t.background.option},model:{value:t.background.radius,callback:function(e){t.$set(t.background,"radius",e)},expression:"background.radius"}})],1)])]},proxy:!0}])})],1)],1)],1),e("div",{staticClass:"text-center"},[e(c.Z,{attrs:{color:"primary",disabled:t.loading||0==t.files.length,rounded:""},on:{click:t.onSubmit}},[t._v("Square Fit'em")])],1)])],1),t.completed.length>0?[e("p",{staticClass:"title mb-2"},[t._v("Completed")]),e(x.Z,{staticClass:"rounded-xl",attrs:{rounded:""}},[t._l(t.completed,(function(o,a){return[e(_.Z,{key:a,staticClass:"rounded-xl my-1",on:{click:function(e){return t.previewImage(a)}}},[e(y.Z,{attrs:{rounded:"0"}},[e(k.Z,{attrs:{src:o.url}})],1),e(j.Z),e(c.Z,{attrs:{color:o.downloaded?"success":"primary",rounded:""},on:{click:function(e){return e.stopPropagation(),t.downloadImage(a)}}},[e(w.Z,{attrs:{dark:"",left:""}},[t._v(" "+t._s(o.downloaded?"mdi-check":"mdi-download")+" ")]),t._v(" "+t._s(o.downloaded?"Downloaded":"Download")+" ")],1)],1),a!=t.completed.length-1?e(v.Z,{key:a+"divider",attrs:{inset:!1}}):t._e()]}))],2),e(c.Z,{staticClass:"my-5 mx-auto",attrs:{block:"",large:"",color:"primary",rounded:""},on:{click:function(e){return t.bulkDownload()}}},[e(w.Z,{attrs:{dark:"",left:""}},[t._v(" mdi-download ")]),t._v("Download all ")],1),t.completed.some((t=>t.downloaded))&&t.completed.filter((t=>t.downloaded)).length!=t.completed.length?e(c.Z,{staticClass:"mx-auto mb-4",attrs:{block:"",large:"",color:"primary",rounded:""},on:{click:function(e){return t.bulkDownload(!1)}}},[e(w.Z,{attrs:{dark:"",left:""}},[t._v(" mdi-download ")]),t._v("Download remaining ")],1):t._e()]:t._e(),t.errors?e("ul",{staticClass:"list-group list-group-flush"},t._l(t.errors,(function(o,a){return e("li",{key:a,staticClass:"list-group-item text-danger"},[t._v(t._s(a+1)+") "+t._s(o))])})),0):t._e()],2)],1)],1),e(f.Z,{attrs:{width:"500"},model:{value:t.preview,callback:function(e){t.preview=e},expression:"preview"}},[null!=t.previewIndex?e(O.Z,{staticClass:"pa-4 text-center",attrs:{rounded:"",set:t.image=t.completed[t.previewIndex]}},[e(k.Z,{staticClass:"mb-3",attrs:{src:t.image.url,alt:"Square pic result"}},[e("div",{staticClass:"image-controls",class:{"left-end":0==t.previewIndex,"right-end":t.previewIndex==t.completed.length-1}},[e("div",{staticClass:"left",on:{click:function(e){t.previewIndex>0&&t.previewIndex--}}},[e(w.Z,{attrs:{"x-large":""}},[t._v("mdi-chevron-left")])],1),e("div",{staticClass:"right",on:{click:function(e){t.previewIndex<t.completed.length-1&&t.previewIndex++}}},[e(w.Z,{attrs:{"x-large":""}},[t._v("mdi-chevron-right")])],1)])]),e(c.Z,{attrs:{color:t.image.downloaded?"success":"primary",rounded:""},on:{click:function(e){return t.downloadImage(t.previewIndex)}}},[e(w.Z,{attrs:{dark:"",left:""}},[t._v(" "+t._s(t.image.downloaded?"mdi-check":"mdi-download")+" ")]),t._v(" "+t._s(t.image.downloaded?"Downloaded":"Download")+" ")],1)],1):t._e()],1),e(D.Z,{attrs:{timeout:t.snackbar.timeout,color:t.snackbar.color},model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[t._v(" "+t._s(t.snackbar.msg))])],1)},P=[],H=(o(8675),o(7380),o(1118),o(1703),{name:"HomeView",data(){return{files:[],loading:!1,errors:[],previewIndex:null,preview:!1,background:{option:"automatic",selected:"#FFFFFF",radius:8},progress:{total:0,loaded:0},dim:2048,ctx:null,completed:[],suffix:(new Date).getTime().toString(32),snackbar:{show:!1,timeout:2e3,color:"success",msg:""},count:0}},computed:{percentage(){return 100*this.progress.loaded/(this.progress.total||1)}},watch:{"progress.loaded":function(t,e){t==this.progress.total&&(this.showSnackBar("Process complete.","success"),setTimeout((()=>{this.loading=!1}),1e3),this.files=[],window.localStorage.setItem("converted-count",this.count))}},methods:{showSnackBar(t,e="success"){const o=this.snackbar;o.msg=t,o.color=e,o.show=!0},addToCompleted(t,e){this.completed.push({url:t,downloaded:!1,filename:e})},previewImage(t){this.previewIndex=t,this.preview=!0},downloadImage(t){const e=this.completed[t];var o=document.createElement("a");o.href=e.url,o.download=e.filename,document.body.appendChild(o),o.click(),o.remove(),e.downloaded=!0},bulkDownload(t=!0){this.completed.forEach(((e,o)=>{!t&&e.downloaded||this.downloadImage(o)}))},componentToHex(t){var e=t.toString(16);return 1==e.length?"0"+e:e},rgbToHex(t,e,o){return"#"+this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(o)},getAutomaticColor(t){const e=document.createElement("canvas");e.height=t.height,e.width=t.width;const o=e.getContext("2d");o.drawImage(t,0,0);const a={};if(t.height>t.width){const e=new Uint8ClampedArray([...o.getImageData(0,0,1,t.height).data,...o.getImageData(t.width-1,0,1,t.height).data]);for(let o=0;o<4*t.height*2;o+=4){const t=this.rgbToHex(e[o],e[o+1],e[o+2]);a[t]=(a[t]??0)+1}}else{const e=new Uint8ClampedArray([...o.getImageData(0,0,t.width,1).data,...o.getImageData(0,t.height-1,t.width,1).data]);for(let o=0;o<4*t.width*2;o+=4){const t=this.rgbToHex(e[o],e[o+1],e[o+2]);a[t]=(a[t]??0)+1}}let n,r=-1;console.log(a);for(let[i,s]of Object.entries(a))s>r&&(n=i,r=s);return n},handleOnline(t,e){let o=new FormData;o.append("image",t),fetch(`?${e.toString()}`,{method:"POST",body:o}).then((t=>{if(t.ok)return t.blob();throw new Error(t.statusText)})).then((t=>{var e=window.URL.createObjectURL(t);this.addToCompleted(e)})).catch((t=>{this.errors.push(t.message)})).then((()=>{this.progress.loaded++}))},handleOffline(t){const e=new FileReader;e.addEventListener("load",(()=>{const t=new Image;t.src=e.result;const o=this.background.option;t.onload=()=>{let e=this.background.selected;const a=t.height,n=t.width;if(this.ctx.clearRect(0,0,this.dim,this.dim),this.ctx.beginPath(),this.ctx.rect(0,0,this.dim,this.dim),["automatic","blur"].includes(o)&&(e=this.getAutomaticColor(t)),["automatic","custom","blur"].includes(o)&&(this.ctx.fillStyle=e,this.ctx.fill()),"blur"===o){let e,o;this.ctx.filter=`blur(${this.background.radius}px)`,n>a?(e=n*(this.dim/a),o=this.dim,this.ctx.drawImage(t,(this.dim-e)/2,0,e,o)):(o=a*(this.dim/n),e=this.dim,this.ctx.drawImage(t,0,(this.dim-o)/2,e,o)),this.ctx.filter="blur(0px)"}let r,i,s=0,l=0;a>n?(r=n/(a/this.dim),i=this.dim,s=(this.dim-r)/2,l=0):(i=a/(n/this.dim),r=this.dim,s=0,l=(this.dim-i)/2),this.ctx.drawImage(t,s,l,r,i),this.progress.loaded++,this.count++;const c="transparent"==o?"png":"jpeg";this.addToCompleted(this.ctx.canvas.toDataURL(`image/${c}`),`Bulk-Squarefit ${(new Date).toISOString().slice(0,10)}-${this.count}.${c}`)}}),!1),e.readAsDataURL(t)},onSubmit(){if(this.files.length){this.loading=!0,this.progress.loaded=0,this.progress.total=this.files.length;for(let t of this.files)this.handleOffline(t)}else this.showSnackBar("Add images","red")}},mounted(){const t=document.createElement("canvas");t.height=this.dim,t.width=this.dim,this.ctx=t.getContext("2d")},created(){this.count=Number(window.localStorage.getItem("converted-count")??0)}}),$=H,B=o(1001),A=(0,B.Z)($,F,P,!1,null,null,null),E=A.exports,q={name:"App",components:{HomeView:E},data:()=>({})},L=q,R=(0,B.Z)(L,s,l,!1,null,null,null),U=R.exports,M=o(7813),V=o(2638);a.ZP.use(M.Z);var z=new M.Z({theme:{dark:!0,themes:{dark:{primary:V.Z.purple}}}});a.ZP.config.productionTip=!1,new a.ZP({vuetify:z,render:t=>t(U)}).$mount("#app")}},e={};function o(a){var n=e[a];if(void 0!==n)return n.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,o),r.exports}o.m=t,function(){var t=[];o.O=function(e,a,n,r){if(!a){var i=1/0;for(d=0;d<t.length;d++){a=t[d][0],n=t[d][1],r=t[d][2];for(var s=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(o.O).every((function(t){return o.O[t](a[l])}))?a.splice(l--,1):(s=!1,r<i&&(i=r));if(s){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[a,n,r]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={826:0};o.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,r,i=a[0],s=a[1],l=a[2],c=0;if(i.some((function(e){return 0!==t[e]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var d=l(o)}for(e&&e(a);c<i.length;c++)r=i[c],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(d)},a=self["webpackChunkbulk_squarefit"]=self["webpackChunkbulk_squarefit"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(1803)}));a=o.O(a)})();
//# sourceMappingURL=index.fd644e80.js.map